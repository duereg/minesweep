(function(i){var l=[].slice,c={};i.amplify={publish:function(a){if("string"!==typeof a)throw Error("You must provide a valid topic to publish.");var e=l.call(arguments,1),d,b,f,g=0;if(!c[a])return!0;d=c[a].slice();for(f=d.length;g<f&&!(b=d[g],b=b.callback.apply(b.context,e),!1===b);g++);return!1!==b},subscribe:function(a,e,d,b){if("string"!==typeof a)throw Error("You must provide a valid topic to create a subscription.");3===arguments.length&&"number"===typeof d&&(b=d,d=e,e=null);2===arguments.length&&
(d=e,e=null);for(var b=b||10,f=0,g=a.split(/\s/),i=g.length,j;f<i;f++){a=g[f];j=!1;c[a]||(c[a]=[]);for(var h=c[a].length-1,k={callback:d,context:e,priority:b};0<=h;h--)if(c[a][h].priority<=b){c[a].splice(h+1,0,k);j=!0;break}j||c[a].unshift(k)}return d},unsubscribe:function(a,e){if("string"!==typeof a)throw Error("You must provide a valid topic to remove a subscription.");if(c[a])for(var d=c[a].length,b=0;b<d;b++)if(c[a][b].callback===e){c[a].splice(b,1);break}}}})(this);